<!DOCTYPE html>
<html>
	<head>
		<title>Notorious</title>
		<style type="text/css" media="screen">
			::-webkit-scrollbar {
				display: none;
			}

			body {
				overflow: hidden;
			}

			#editor {
				margin: 0;
				position: absolute;
				top: 0;
				bottom: 0;
				left: 0;
				right: 0;
			}
		</style>
	</head>
	<body>
		<pre id="editor"></pre>
		<script src="app://notorious/lib/ace/ace.js"></script>
		<script src="app://notorious/lib/ace/theme-cobalt.js"></script>
		<script src="app://notorious/lib/ace/ext-split.js"></script>
		<script src="app://notorious/lib/ace/ext-language_tools.js"></script>
		<script>
			/*
			 * Get the path to the user's home folder
			 * independently of the platform
			 *
			 * @return string The full path to the home folder
			 */
			function getHomePath() {
				return process.env[(process.platform == 'win32') ? 'USERPROFILE' : 'HOME'];
			}

			// Load extensions and themes
			var language_tools = ace.require("ace/ext/language_tools"),
				split = ace.require("ace/ext/split"),
				theme = ace.require("ace/theme/cobalt");

			// Initialize editor
			var splits = new split.Split(document.getElementById('editor'), theme, 1),
				editor = splits.getCurrentEditor();

			// Setup
			splits.forEach(function (editor) {
				editor.getSession().setMode("ace/mode/javascript");
				editor.setOptions({
					enableBasicAutocompletion: true,
					enableSnippets: true
				});
			});

			// Forcing the session will keep the splits in sync
			// TODO: detect the document being opened in a split
			// and if it's already opened force the session
			// var session = editor.getSession();
			// splits.setSession(session, 1);

			window.addEventListener('resize', function (){
				splits.resize();
			});

			window.addEventListener('load', function() {
				require('nw.gui').Window.get().show();
				splits.focus();
			});
		</script>
	</body>
</html>
